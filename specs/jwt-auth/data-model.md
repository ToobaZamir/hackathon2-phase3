# JWT Authentication Data Model

## Entities

### User
- **Purpose**: Store user account information and authentication data
- **Table Name**: users

#### Fields
- `id` (Integer, Primary Key, Auto-increment)
  - Unique identifier for each user
  - Auto-generated by database
- `username` (String(50), Unique, Not Null)
  - Unique username for login
  - Min length: 3, Max length: 50
- `email` (String(100), Unique, Not Null)
  - Email address for the user
  - Min length: 5, Max length: 100
- `hashed_password` (String, Not Null)
  - Bcrypt hash of user's password
  - Stored securely, never plaintext
- `first_name` (String(50), Nullable)
  - Optional first name
- `last_name` (String(50), Nullable)
  - Optional last name
- `is_active` (Boolean, Default: True)
  - Whether the account is active
  - Allows soft-deletion of accounts
- `created_at` (DateTime with timezone, Not Null)
  - Timestamp when user was created
  - Auto-set to current time
- `updated_at` (DateTime with timezone, Not Null)
  - Timestamp when user was last updated
  - Auto-updates on record changes

#### Constraints
- Username must be unique
- Email must be unique
- Username length between 3-50 characters
- Email format validation
- Password must be at least 6 characters (before hashing)

#### Indexes
- Index on username (for login queries)
- Index on email (for lookup queries)

### Task (Updated)
- **Purpose**: Existing task model with updated relationship to User
- **Table Name**: tasks

#### Additional Relationship
- Foreign Key: user_id references User.id
- Cascade: Tasks remain when user is deactivated (soft-delete)
- Index: Index on user_id for efficient filtering

## Relationships
- One User to Many Tasks (one-to-many)
  - A user can own multiple tasks
  - Each task belongs to one user
  - Tasks are filtered by user_id for isolation

## Validation Rules
- User registration:
  - Username uniqueness check
  - Email format validation
  - Password strength (min 6 chars)
- User login:
  - Account active status check
  - Password verification against hash
- Task access:
  - User ID must match task owner
  - Unauthorized users get 404 (not 403) for security

## State Transitions
- User activation/deactivation:
  - Active user can access system
  - Inactive user cannot authenticate
- Password changes:
  - Old password verification required
  - New password hashed before storage